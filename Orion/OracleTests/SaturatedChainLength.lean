/-
  Orion/OracleTests/SaturatedChainLength.lean

  Test file for Proof Oracle: saturated chain length in a â„•-graded order.
  Self-contained â€” can be removed after verification.
-/

import Mathlib

namespace Orion.OracleTests.SaturatedChainLength

-- Proof below this line is generated by the Proof Oracle.

theorem saturatedChain_length [Preorder Î±] [GradeMinOrder â„• Î±] (l : List Î±)
    (hl : l.Chain' (Â· â‹– Â·)) (hne : l â‰  []) :
    grade â„• (l.getLast hne) = grade â„• (l.head hne) + (l.length - 1) := by
  induction l with
  | nil => exact absurd rfl hne
  | cons a t ih =>
    cases t with
    | nil => simp
    | cons b rest =>
      have hne' : b :: rest â‰  [] := List.cons_ne_nil _ _
      have htail : (b :: rest).Chain' (Â· â‹– Â·) := List.IsChain.tail hl
      have hrel : a â‹– b := List.IsChain.rel_head hl
      have ih' := ih htail hne'
      have hgrad : grade â„• a + 1 = grade â„• b :=
        Order.covBy_iff_add_one_eq.mp (hrel.grade (ğ•† := â„•))
      rw [show (a :: b :: rest).getLast hne = (b :: rest).getLast hne' from
        List.getLast_cons hne']
      simp only [List.head_cons, List.length_cons] at ih' âŠ¢
      omega

end Orion.OracleTests.SaturatedChainLength
